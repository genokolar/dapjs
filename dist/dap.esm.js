var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function c(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,c)}u((r=r.apply(t,e||[])).next())}))}function r(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(t){c=[6,t],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}function i(){}function s(){s.init.call(this)}function o(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function c(t,e,n,r){var s,c,u,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((c=t._events)?(c.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),c=t._events),u=c[e]):(c=t._events=new i,t._eventsCount=0),u){if("function"==typeof u?u=c[e]=r?[n,u]:[u,n]:r?u.unshift(n):u.push(n),!u.warned&&(s=o(t))&&s>0&&u.length>s){u.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=u.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else u=c[e]=n,++t._eventsCount;return t}function u(t,e,n){var r=!1;function i(){t.removeListener(e,i),r||(r=!0,n.apply(t,arguments))}return i.listener=n,i}function a(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function h(t,e){for(var n=new Array(e);e--;)n[e]=t[e];return n}"function"==typeof SuppressedError&&SuppressedError,i.prototype=Object.create(null),s.EventEmitter=s,s.usingDomains=!1,s.prototype.domain=void 0,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.init=function(){this.domain=null,s.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new i,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return o(this)},s.prototype.emit=function(t){var e,n,r,i,s,o,c,u="error"===t;if(o=this._events)u=u&&null==o.error;else if(!u)return!1;if(c=this.domain,u){if(e=arguments[1],!c){if(e instanceof Error)throw e;var a=new Error('Uncaught, unspecified "error" event. ('+e+")");throw a.context=e,a}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=c,e.domainThrown=!1,c.emit("error",e),!1}if(!(n=o[t]))return!1;var f="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=h(t,r),s=0;s<r;++s)i[s].call(n)}(n,f,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,s=h(t,i),o=0;o<i;++o)s[o].call(n,r)}(n,f,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var s=t.length,o=h(t,s),c=0;c<s;++c)o[c].call(n,r,i)}(n,f,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,s){if(e)t.call(n,r,i,s);else for(var o=t.length,c=h(t,o),u=0;u<o;++u)c[u].call(n,r,i,s)}(n,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,s=h(t,i),o=0;o<i;++o)s[o].apply(n,r)}(n,f,this,i)}return!0},s.prototype.addListener=function(t,e){return c(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return c(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,u(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,u(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,s,o,c;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener&&n.listener===e)0==--this._eventsCount?this._events=new i:(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(s=-1,o=n.length;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){c=n[o].listener,s=o;break}if(s<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new i,this;delete r[t]}else!function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,s);r.removeListener&&this.emit("removeListener",t,c||e)}return this},s.prototype.off=function(t,e){return this.removeListener(t,e)},s.prototype.removeAllListeners=function(t){var e,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new i,this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=new i:delete n[t]),this;if(0===arguments.length){for(var r,s=Object.keys(n),o=0;o<s.length;++o)"removeListener"!==(r=s[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new i,this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},s.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):a.call(t,e)},s.prototype.listenerCount=a,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var f,l=1e7,d=function(){function t(){this.locked=!1}return t.prototype.lock=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return this.locked?[4,new Promise((function(t){return setTimeout(t,1)}))]:[3,2];case 1:return t.sent(),[3,0];case 2:return this.locked=!0,[2]}}))}))},t.prototype.unlock=function(){this.locked=!1},t}(),p=function(t){function i(e,n,r){void 0===n&&(n=0),void 0===r&&(r=l);var i=t.call(this)||this;i.transport=e,i.mode=n,i.clockFrequency=r,i.connected=!1,i.sendMutex=new d,i.blockSize=i.transport.packetSize-4-1;var s=i.transport.packetSize-2-1;return i.operationCount=Math.floor(s/5),i}return e(i,t),i.prototype.bufferSourceToUint8Array=function(t,e){if(!e)return new Uint8Array([t]);var n=void 0!==e.buffer?e.buffer:e,r=new Uint8Array(n.byteLength+1);return r.set([t]),r.set(new Uint8Array(n),1),r},i.prototype.selectProtocol=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return e=2===t?59196:59294,[4,this.swjSequence(new Uint8Array([255,255,255,255,255,255,255]))];case 1:return n.sent(),[4,this.swjSequence(new Uint16Array([e]))];case 2:return n.sent(),[4,this.swjSequence(new Uint8Array([255,255,255,255,255,255,255]))];case 3:return n.sent(),[4,this.swjSequence(new Uint8Array([0]))];case 4:return n.sent(),[2]}}))}))},i.prototype.send=function(t,e){return n(this,void 0,void 0,(function(){var n,i;return r(this,(function(r){switch(r.label){case 0:return n=this.bufferSourceToUint8Array(t,e),[4,this.sendMutex.lock()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,,5,6]),[4,this.transport.write(n)];case 3:return r.sent(),[4,this.transport.read()];case 4:if((i=r.sent()).getUint8(0)!==t)throw new Error("Bad response for ".concat(t," -> ").concat(i.getUint8(0)));switch(t){case 3:case 8:case 9:case 10:case 17:case 18:case 19:case 29:case 23:case 24:case 26:case 21:case 22:case 4:if(0!==i.getUint8(1))throw new Error("Bad status for ".concat(t," -> ").concat(i.getUint8(1)))}return[2,i];case 5:return this.sendMutex.unlock(),[7];case 6:return[2]}}))}))},i.prototype.clearAbort=function(){return n(this,arguments,void 0,(function(t){return void 0===t&&(t=30),r(this,(function(e){switch(e.label){case 0:return[4,this.send(8,new Uint8Array([0,t]))];case 1:return e.sent(),[2]}}))}))},i.prototype.dapInfo=function(t){return n(this,void 0,void 0,(function(){var e,n,i,s;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,4]),[4,this.send(0,new Uint8Array([t]))];case 1:if(e=r.sent(),0===(n=e.getUint8(1)))return[2,""];switch(t){case 240:case 254:case 255:case 253:if(1===n)return[2,e.getUint8(2)];if(2===n)return[2,e.getUint16(2)];if(4===n)return[2,e.getUint32(2)]}return i=Array.prototype.slice.call(new Uint8Array(e.buffer,2,n)),[2,String.fromCharCode.apply(null,i)];case 2:return s=r.sent(),[4,this.clearAbort()];case 3:throw r.sent(),s;case 4:return[2]}}))}))},i.prototype.swjSequence=function(t){return n(this,arguments,void 0,(function(t,e){var n,i;return void 0===e&&(e=8*t.byteLength),r(this,(function(r){switch(r.label){case 0:n=this.bufferSourceToUint8Array(e,t),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.send(18,n)];case 2:return r.sent(),[3,5];case 3:return i=r.sent(),[4,this.clearAbort()];case 4:throw r.sent(),i;case 5:return[2]}}))}))},i.prototype.swjClock=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),[4,this.send(17,new Uint8Array([255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24]))];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),[4,this.clearAbort()];case 3:throw n.sent(),e;case 4:return[2]}}))}))},i.prototype.swjPins=function(t,e,i){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,4]),[4,this.send(16,new Uint8Array([t,e,255&i,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24]))];case 1:return[2,r.sent().getUint8(1)];case 2:return n=r.sent(),[4,this.clearAbort()];case 3:throw r.sent(),n;case 4:return[2]}}))}))},i.prototype.dapDelay=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),[4,this.send(9,new Uint8Array([255&t,(65280&t)>>8]))];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),[4,this.clearAbort()];case 3:throw n.sent(),e;case 4:return[2]}}))}))},i.prototype.configureTransfer=function(t,e,i){return n(this,void 0,void 0,(function(){var n,s,o;return r(this,(function(r){switch(r.label){case 0:n=new Uint8Array(5),(s=new DataView(n.buffer)).setUint8(0,t),s.setUint16(1,e,!0),s.setUint16(3,i,!0),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.send(4,n)];case 2:return r.sent(),[3,5];case 3:return o=r.sent(),[4,this.clearAbort()];case 4:throw r.sent(),o;case 5:return[2]}}))}))},i.prototype.connect=function(){return n(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(r){switch(r.label){case 0:return!0===this.connected?[2]:[4,this.transport.open()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,5,,8]),[4,this.send(17,new Uint32Array([this.clockFrequency]))];case 3:return r.sent(),[4,this.send(2,new Uint8Array([this.mode]))];case 4:if(0===(t=r.sent()).getUint8(1)||0!==this.mode&&t.getUint8(1)!==this.mode)throw new Error("Mode not enabled.");return[3,8];case 5:return e=r.sent(),[4,this.clearAbort()];case 6:return r.sent(),[4,this.transport.close()];case 7:throw r.sent(),e;case 8:return r.trys.push([8,11,,13]),[4,this.configureTransfer(0,100,0)];case 9:return r.sent(),[4,this.selectProtocol(1)];case 10:return r.sent(),[3,13];case 11:return n=r.sent(),[4,this.transport.close()];case 12:throw r.sent(),n;case 13:return this.connected=!0,[2]}}))}))},i.prototype.disconnect=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:if(!1===this.connected)return[2];e.label=1;case 1:return e.trys.push([1,3,,5]),[4,this.send(3)];case 2:return e.sent(),[3,5];case 3:return t=e.sent(),[4,this.clearAbort()];case 4:throw e.sent(),t;case 5:return[4,this.transport.close()];case 6:return e.sent(),this.connected=!1,[2]}}))}))},i.prototype.reconnect=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.disconnect()];case 1:return t.sent(),[4,new Promise((function(t){return setTimeout(t,100)}))];case 2:return t.sent(),[4,this.connect()];case 3:return t.sent(),[2]}}))}))},i.prototype.reset=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,4]),[4,this.send(10)];case 1:return[2,1===e.sent().getUint8(2)];case 2:return t=e.sent(),[4,this.clearAbort()];case 3:throw e.sent(),t;case 4:return[2]}}))}))},i.prototype.transfer=function(t){return n(this,arguments,void 0,(function(t,e,n,i){var s,o,c,u,a,h,f;return void 0===e&&(e=2),void 0===n&&(n=0),void 0===i&&(i=0),r(this,(function(r){switch(r.label){case 0:s="number"==typeof t?[{port:t,mode:e,register:n,value:i}]:t,o=new Uint8Array(2+5*s.length),(c=new DataView(o.buffer)).setUint8(0,0),c.setUint8(1,s.length),s.forEach((function(t,e){var n=2+5*e;c.setUint8(n,t.port|t.mode|t.register),c.setUint32(n+1,t.value||0,!0)})),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.send(5,o)];case 2:if((u=r.sent()).getUint8(1)!==s.length)throw new Error("Transfer count mismatch");if(2===(a=u.getUint8(2)))throw new Error("Transfer response WAIT");if(4===a)throw new Error("Transfer response FAULT");if(8===a)throw new Error("Transfer response PROTOCOL_ERROR");if(16===a)throw new Error("Transfer response VALUE_MISMATCH");if(7===a)throw new Error("Transfer response NO_ACK");return"number"==typeof t?[2,u.getUint32(3,!0)]:(h=4*s.length,[2,new Uint32Array(u.buffer.slice(3,3+h))]);case 3:return f=r.sent(),[4,this.clearAbort()];case 4:throw r.sent(),f;case 5:return[2]}}))}))},i.prototype.transferBlock=function(t,e,i){return n(this,void 0,void 0,(function(){var n,s,o,c,u,a,h,f;return r(this,(function(r){switch(r.label){case 0:o=4,"number"==typeof i?(n=i,s=2):(n=i.length,s=0,o+=i.byteLength),c=new Uint8Array(o),(u=new DataView(c.buffer)).setUint8(0,0),u.setUint16(1,n,!0),u.setUint8(3,t|s|e),"number"!=typeof i&&i.forEach((function(t,e){var n=4+4*e;u.setUint32(n,t,!0)})),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.send(6,u)];case 2:if((a=r.sent()).getUint16(1,!0)!==n)throw new Error("Transfer count mismatch");if(2===(h=a.getUint8(3)))throw new Error("Transfer response WAIT");if(4===h)throw new Error("Transfer response FAULT");if(8===h)throw new Error("Transfer response PROTOCOL_ERROR");if(7===h)throw new Error("Transfer response NO_ACK");return"number"==typeof i?[2,new Uint32Array(a.buffer.slice(4,4+4*n))]:[3,5];case 3:return f=r.sent(),[4,this.clearAbort()];case 4:throw r.sent(),f;case 5:return[2,void 0]}}))}))},i}(s),v=/[\xc0-\xff][\x80-\xbf]*$/g,w=/[\xc0-\xff][\x80-\xbf]*/g,m=function(){function t(){}return t.prototype.decode=function(t){var e=Array.prototype.slice.call(new Uint8Array(t)),n=String.fromCodePoint.apply(void 0,e);this.partialChar&&(n="".concat(this.partialChar).concat(n),this.partialChar=void 0);var r=n.match(v);if(r){var i=r[0].length;this.partialChar=n.slice(-i),n=n.slice(0,-i)}return n.replace(w,this.decoderReplacer)},t.prototype.decoderReplacer=function(t){var e=t.codePointAt(0)<<24,n=Math.clz32(~e),r=0,i=t.length,s="";if(n<5&&i>=n){for(e=e<<n>>>24+n,r=1;r<n;r+=1)e=e<<6|63&t.codePointAt(r);e<=65535?s+=String.fromCodePoint(e):e<=1114111?(e-=65536,s+=String.fromCodePoint(55296+(e>>10),56320+(1023&e))):r=0}for(;r<i;r+=1)s+="�";return s},t}(),y=new m,b=function(t){function i(e,n,r){void 0===n&&(n=0),void 0===r&&(r=l);var s=t.call(this,e,n,r)||this;return s.serialPolling=!1,s.serialListeners=!1,s.on("newListener",(function(t){t===i.EVENT_SERIAL_DATA&&(0===s.listenerCount(t)&&(s.serialListeners=!0))})),s.on("removeListener",(function(t){t===i.EVENT_SERIAL_DATA&&(0===s.listenerCount(t)&&(s.serialListeners=!1))})),s}return e(i,t),i.prototype.isBufferBinary=function(t){for(var e=Array.prototype.slice.call(new Uint16Array(t,0,50)),n=String.fromCharCode.apply(null,e),r=0;r<n.length;r++){var i=n.charCodeAt(r);if(65533===i||i<=8)return!0}return!1},i.prototype.writeBuffer=function(t,e){return n(this,arguments,void 0,(function(t,e,n){var s,o,c,u;return void 0===n&&(n=0),r(this,(function(r){switch(r.label){case 0:s=Math.min(t.byteLength,n+e),o=t.slice(n,s),(c=new Uint8Array(o.byteLength+1)).set([o.byteLength]),c.set(new Uint8Array(o),1),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.send(140,c)];case 2:return r.sent(),[3,5];case 3:return u=r.sent(),[4,this.clearAbort()];case 4:throw r.sent(),u;case 5:return this.emit(i.EVENT_PROGRESS,n/t.byteLength),s<t.byteLength?[2,this.writeBuffer(t,e,s)]:[2]}}))}))},i.prototype.flash=function(t){return n(this,arguments,void 0,(function(t,e){var n,s,o;return void 0===e&&(e=62),r(this,(function(r){switch(r.label){case 0:n=function(t){return void 0!==t.buffer}(t)?t.buffer:t,s=this.isBufferBinary(n)?0:1,r.label=1;case 1:return r.trys.push([1,6,,8]),[4,this.send(138,new Uint32Array([s]))];case 2:if(0!==r.sent().getUint8(1))throw new Error("Flash error");return[4,this.writeBuffer(n,e)];case 3:return r.sent(),this.emit(i.EVENT_PROGRESS,1),[4,this.send(139)];case 4:if(0!==r.sent().getUint8(1))throw new Error("Flash error");return[4,this.send(137)];case 5:return r.sent(),[3,8];case 6:return o=r.sent(),[4,this.clearAbort()];case 7:throw r.sent(),o;case 8:return[2]}}))}))},i.prototype.getSerialBaudrate=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,4]),[4,this.send(129)];case 1:return[2,e.sent().getUint32(1,!0)];case 2:return t=e.sent(),[4,this.clearAbort()];case 3:throw e.sent(),t;case 4:return[2]}}))}))},i.prototype.setSerialBaudrate=function(){return n(this,arguments,void 0,(function(t){var e;return void 0===t&&(t=9600),r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),[4,this.send(130,new Uint32Array([t]))];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),[4,this.clearAbort()];case 3:throw n.sent(),e;case 4:return[2]}}))}))},i.prototype.serialWrite=function(t){return n(this,void 0,void 0,(function(){var e,n;return r(this,(function(r){switch(r.label){case 0:(e=t.split("").map((function(t){return t.charCodeAt(0)}))).unshift(e.length),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.send(132,new Uint8Array(e).buffer)];case 2:return r.sent(),[3,5];case 3:return n=r.sent(),[4,this.clearAbort()];case 4:throw r.sent(),n;case 5:return[2]}}))}))},i.prototype.serialRead=function(){return n(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,4]),[4,this.send(131)];case 1:return 0===(t=r.sent()).byteLength||(131!==t.getUint8(0)||0===(e=t.getUint8(1)))?[2,void 0]:(2,[2,t.buffer.slice(2,2+e)]);case 2:return n=r.sent(),[4,this.clearAbort()];case 3:throw r.sent(),n;case 4:return[2]}}))}))},i.prototype.startSerialRead=function(){return n(this,arguments,void 0,(function(t,e){var n,s,o;return void 0===t&&(t=100),void 0===e&&(e=!0),r(this,(function(r){switch(r.label){case 0:this.serialPolling=!0,r.label=1;case 1:return this.serialPolling?this.serialListeners?(n=this.connected,!1!==this.connected||!0!==e?[3,3]:[4,this.connect()]):[3,7]:[3,9];case 2:r.sent(),r.label=3;case 3:return[4,this.serialRead()];case 4:return s=r.sent(),!1!==n||!0!==e?[3,6]:[4,this.disconnect()];case 5:r.sent(),r.label=6;case 6:void 0!==s&&(o=y.decode(s),this.emit(i.EVENT_SERIAL_DATA,o)),r.label=7;case 7:return[4,new Promise((function(e){return setTimeout(e,t)}))];case 8:return r.sent(),[3,1];case 9:return[2]}}))}))},i.prototype.stopSerialRead=function(){this.serialPolling=!1},i.EVENT_PROGRESS="progress",i.EVENT_SERIAL_DATA="serial",i}(p),g=1024,A=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=l);this.proxy=void 0!==t.open?new p(t,e,n):t}return t.prototype.waitDelay=function(t){return n(this,arguments,void 0,(function(t,e,n){var i;return void 0===e&&(e=0),void 0===n&&(n=100),r(this,(function(r){switch(r.label){case 0:i=!0,e>0&&setTimeout((function(){if(i)throw i=!1,new Error("Wait timed out")}),e),r.label=1;case 1:return i?[4,t()]:[3,5];case 2:return!0===r.sent()?(i=!1,[2]):n>0?[4,new Promise((function(t){return setTimeout(t,n)}))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[3,1];case 5:return[2]}}))}))},t.prototype.concatTypedArray=function(t){if(1===t.length)return t[0];for(var e=0,n=0,r=t;n<r.length;n++){e+=r[n].length}for(var i=new Uint32Array(e),s=0,o=0;s<t.length;s++)i.set(t[s],o),o+=t[s].length;return i},t.prototype.readDPCommand=function(t){return[{mode:2,port:0,register:t}]},t.prototype.writeDPCommand=function(t,e){if(8===t){if(e===this.selectedAddress)return[];this.selectedAddress=e}return[{mode:0,port:0,register:t,value:e}]},t.prototype.readAPCommand=function(t){var e=4278190080&t|240&t;return this.writeDPCommand(8,e).concat({mode:2,port:1,register:t})},t.prototype.writeAPCommand=function(t,e){if(0===t){if(e===this.cswValue)return[];this.cswValue=e}var n=4278190080&t|240&t;return this.writeDPCommand(8,n).concat({mode:0,port:1,register:t,value:e})},t.prototype.readMem8Command=function(t){return this.writeAPCommand(0,587202640).concat(this.writeAPCommand(4,t)).concat(this.readAPCommand(12))},t.prototype.writeMem8Command=function(t,e){return this.writeAPCommand(0,587202640).concat(this.writeAPCommand(4,t)).concat(this.writeAPCommand(12,e))},t.prototype.readMem16Command=function(t){return this.writeAPCommand(0,587202641).concat(this.writeAPCommand(4,t)).concat(this.readAPCommand(12))},t.prototype.writeMem16Command=function(t,e){return this.writeAPCommand(0,587202641).concat(this.writeAPCommand(4,t)).concat(this.writeAPCommand(12,e))},t.prototype.readMem32Command=function(t){return this.writeAPCommand(0,587202642).concat(this.writeAPCommand(4,t)).concat(this.readAPCommand(12))},t.prototype.writeMem32Command=function(t,e){return this.writeAPCommand(0,587202642).concat(this.writeAPCommand(4,t)).concat(this.writeAPCommand(12,e))},t.prototype.transferSequence=function(t){return n(this,void 0,void 0,(function(){var e,n,i,s;return r(this,(function(r){switch(r.label){case 0:e=(e=[]).concat.apply(e,t),n=[],r.label=1;case 1:return e.length?(i=e.splice(0,this.proxy.operationCount),[4,this.proxy.transfer(i)]):[3,3];case 2:return s=r.sent(),n.push(s),[3,1];case 3:return[2,this.concatTypedArray(n)]}}))}))},t.prototype.connect=function(){return n(this,void 0,void 0,(function(){var t,e=this;return r(this,(function(i){switch(i.label){case 0:return t=-1610612736,[4,this.proxy.connect()];case 1:return i.sent(),[4,this.readDP(0)];case 2:return i.sent(),[4,this.transferSequence([this.writeDPCommand(0,4),this.writeDPCommand(8,0),this.writeDPCommand(4,1342177280)])];case 3:return i.sent(),[4,this.waitDelay((function(){return n(e,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.readDP(4)];case 1:return[2,(e.sent()&t)===t]}}))}))}))];case 4:return i.sent(),[2]}}))}))},t.prototype.disconnect=function(){return this.proxy.disconnect()},t.prototype.reconnect=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.disconnect()];case 1:return t.sent(),[4,new Promise((function(t){return setTimeout(t,100)}))];case 2:return t.sent(),[4,this.connect()];case 3:return t.sent(),[2]}}))}))},t.prototype.reset=function(){return this.proxy.reset()},t.prototype.readDP=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.proxy.transfer(this.readDPCommand(t))];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.writeDP=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,this.proxy.transfer(this.writeDPCommand(t,e))];case 1:return n.sent(),[2]}}))}))},t.prototype.readAP=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.proxy.transfer(this.readAPCommand(t))];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.writeAP=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,this.proxy.transfer(this.writeAPCommand(t,e))];case 1:return n.sent(),[2]}}))}))},t.prototype.readMem8=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.proxy.transfer(this.readMem8Command(t))];case 1:return[2,e.sent()[0]>>((3&t)<<3)&255]}}))}))},t.prototype.writeMem8=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return e<<=(3&t)<<3,[4,this.proxy.transfer(this.writeMem8Command(t,e))];case 1:return n.sent(),[2]}}))}))},t.prototype.readMem16=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.proxy.transfer(this.readMem16Command(t))];case 1:return[2,e.sent()[0]>>((2&t)<<3)&65535]}}))}))},t.prototype.writeMem16=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return e<<=(2&t)<<3,[4,this.proxy.transfer(this.writeMem16Command(t,e))];case 1:return n.sent(),[2]}}))}))},t.prototype.readMem32=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.proxy.transfer(this.readMem32Command(t))];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.writeMem32=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,this.proxy.transfer(this.writeMem32Command(t,e))];case 1:return n.sent(),[2]}}))}))},t.prototype.readMem32Sequence=function(t,e){return n(this,void 0,void 0,(function(){var n,i,s,o;return r(this,(function(r){switch(r.label){case 0:return[4,this.transferSequence([this.writeAPCommand(0,587202642),this.writeAPCommand(4,t)])];case 1:r.sent(),n=[],i=e,r.label=2;case 2:return i>0?(s=Math.min(i,Math.floor(this.proxy.blockSize/4)),[4,this.proxy.transferBlock(1,12,s)]):[3,4];case 3:return o=r.sent(),n.push(o),i-=s,[3,2];case 4:return[2,this.concatTypedArray(n)]}}))}))},t.prototype.writeMem32Sequence=function(t,e){return n(this,void 0,void 0,(function(){var n,i;return r(this,(function(r){switch(r.label){case 0:return[4,this.transferSequence([this.writeAPCommand(0,587202642),this.writeAPCommand(4,t)])];case 1:r.sent(),n=0,r.label=2;case 2:return n<e.length?(i=e.slice(n,n+Math.floor(this.proxy.blockSize/4)),[4,this.proxy.transferBlock(1,12,i)]):[3,4];case 3:return r.sent(),n+=Math.floor(this.proxy.blockSize/4),[3,2];case 4:return[2]}}))}))},t.prototype.readBlock=function(t,e){return n(this,void 0,void 0,(function(){var n,i,s,o,c;return r(this,(function(r){switch(r.label){case 0:n=[],i=e,r.label=1;case 1:return i>0?(s=g-t%g,o=Math.min(i,s/4),[4,this.readMem32Sequence(t,o)]):[3,3];case 2:return c=r.sent(),n.push(c),t+=4*o,i-=o,[3,1];case 3:return[2,this.concatTypedArray(n)]}}))}))},t.prototype.writeBlock=function(t,e){return n(this,void 0,void 0,(function(){var n,i,s,o;return r(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<e.length?(i=g-t%g,s=Math.min(e.length-n,i/4),o=e.slice(n,n+s),[4,this.writeMem32Sequence(t,o)]):[3,3];case 2:return r.sent(),t+=4*s,n+=s,[3,1];case 3:return[2]}}))}))},t.prototype.readBytes=function(t,e){return n(this,void 0,void 0,(function(){var n,i,s,o;return r(this,(function(r){switch(r.label){case 0:return n=e,s=t+e&3,(i=3&t)&&(t-=i,n+=i),s&&(n+=4-s),[4,this.readBlock(t,n/4)];case 1:return o=r.sent(),[2,new Uint8Array(o.buffer).slice(i,i+e)]}}))}))},t.prototype.writeBytes=function(t,e){return n(this,void 0,void 0,(function(){var n,i,s,o;return r(this,(function(r){switch(r.label){case 0:return n=e.length,i=0,n>0&&1&t?[4,this.writeMem8(t,e[i])]:[3,2];case 1:r.sent(),n-=1,t+=1,i+=1,r.label=2;case 2:return n>1&&2&t?[4,this.writeMem16(t,e[i]|e[i+1]<<8)]:[3,4];case 3:r.sent(),n-=2,t+=2,i+=2,r.label=4;case 4:return n>=4?(s=n-n%4,o=new Uint32Array(e.slice(i,i+s).buffer),[4,this.writeBlock(t,o)]):[3,6];case 5:r.sent(),n-=s,t+=s,i+=s,r.label=6;case 6:return n>1?[4,this.writeMem16(t,e[i]|e[i+1]<<8)]:[3,8];case 7:r.sent(),n-=2,t+=2,i+=2,r.label=8;case 8:return n>0?[4,this.writeMem8(t,e[i])]:[3,10];case 9:r.sent(),r.label=10;case 10:return[2]}}))}))},t}(),C=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.enableDebug=function(){return this.writeMem32(3758157296,-1604386815)},i.prototype.readCoreRegisterCommand=function(t){return this.writeMem32Command(3758157300,t).concat(this.readMem32Command(3758157296)).concat(this.readMem32Command(3758157304))},i.prototype.writeCoreRegisterCommand=function(t,e){return this.writeMem32Command(3758157304,e).concat(this.writeMem32Command(3758157300,65536|t))},i.prototype.getState=function(){return n(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(r){switch(r.label){case 0:return[4,this.readMem32(3758157296)];case 1:return t=r.sent(),e=524288&t?1:262144&t?2:131072&t?3:4,33554432&t?[4,this.readMem32(3758157296)]:[3,3];case 2:return 33554432&(n=r.sent())&&!(16777216&n)?[2,0]:[2,e];case 3:return[2,e];case 4:return[2]}}))}))},i.prototype.isHalted=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.readMem32(3758157296)];case 1:return[2,!!(131072&t.sent())]}}))}))},i.prototype.halt=function(){return n(this,arguments,void 0,(function(t,e){var n=this;return void 0===t&&(t=!0),void 0===e&&(e=0),r(this,(function(r){switch(r.label){case 0:return[4,this.isHalted()];case 1:return r.sent()?[2]:[4,this.writeMem32(3758157296,-1604386813)];case 2:return r.sent(),t?[2,this.waitDelay((function(){return n.isHalted()}),e)]:[2]}}))}))},i.prototype.resume=function(){return n(this,arguments,void 0,(function(t,e){var i=this;return void 0===t&&(t=!0),void 0===e&&(e=0),r(this,(function(s){switch(s.label){case 0:return[4,this.isHalted()];case 1:return s.sent()?[4,this.writeMem32(3758157104,7)]:[2];case 2:return s.sent(),[4,this.enableDebug()];case 3:return s.sent(),t?[2,this.waitDelay((function(){return n(i,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.isHalted()];case 1:return[2,!t.sent()]}}))}))}),e)]:[2]}}))}))},i.prototype.readCoreRegister=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,this.transferSequence([this.writeMem32Command(3758157300,t),this.readMem32Command(3758157296)])];case 1:if(e=n.sent(),!(65536&e[0]))throw new Error("Register not ready");return[2,this.readMem32(3758157304)]}}))}))},i.prototype.readCoreRegisters=function(t){return n(this,void 0,void 0,(function(){var e,n,i,s,o;return r(this,(function(r){switch(r.label){case 0:e=[],n=0,i=t,r.label=1;case 1:return n<i.length?(s=i[n],[4,this.readCoreRegister(s)]):[3,4];case 2:o=r.sent(),e.push(o),r.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},i.prototype.writeCoreRegister=function(t,e){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:return[4,this.transferSequence([this.writeMem32Command(3758157304,e),this.writeMem32Command(3758157300,65536|t),this.readMem32Command(3758157296)])];case 1:if(n=r.sent(),!(65536&n[0]))throw new Error("Register not ready");return[2]}}))}))},i.prototype.execute=function(t,e,i,s){return n(this,arguments,void 0,(function(t,e,n,i,s){var o,c,u,a,h=this;void 0===s&&(s=t+1);var f=[];for(o=5;o<arguments.length;o++)f[o-5]=arguments[o];return r(this,(function(r){switch(r.label){case 0:for(48682!==e[e.length-1]&&((c=new Uint32Array(e.length+1)).set(e),c.set([48682],e.length-1),e=c),u=[this.writeCoreRegisterCommand(13,n),this.writeCoreRegisterCommand(15,i),this.writeCoreRegisterCommand(14,s)],a=0;a<Math.min(f.length,12);a++)u.push(this.writeCoreRegisterCommand(a,f[a]));return u.push(this.writeCoreRegisterCommand(16,16777216)),[4,this.halt()];case 1:return r.sent(),[4,this.transferSequence(u)];case 2:return r.sent(),[4,this.writeBlock(t,e)];case 3:return r.sent(),[4,this.resume(!1)];case 4:return r.sent(),[4,this.waitDelay((function(){return h.isHalted()}),1e4)];case 5:return r.sent(),[2]}}))}))},i.prototype.softReset=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.writeMem32(3758157308,0)];case 1:return t.sent(),[2,this.writeMem32(3758157068,100270084)]}}))}))},i.prototype.setTargetResetState=function(){return n(this,arguments,void 0,(function(t){var e;return void 0===t&&(t=!0),r(this,(function(n){switch(n.label){case 0:return[4,this.writeMem32(3758157308,1)];case 1:return n.sent(),!0!==t?[3,3]:[4,this.reset()];case 2:return n.sent(),[3,6];case 3:return[4,this.readMem32(3758157068)];case 4:return e=n.sent(),[4,this.writeMem32(3758157068,100270084|e)];case 5:n.sent(),n.label=6;case 6:return[4,this.writeMem32(3758157308,0)];case 7:return n.sent(),[2]}}))}))},i}(A);!function(t){t[t.ENABLE=1]="ENABLE",t[t.KEY=2]="KEY"}(f||(f={}));var U=function(){function t(t){this.device=t,this.os="browser",this.packetSize=64}return t.prototype.open=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2]}))}))},t.prototype.close=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return this.device.close(),[2]}))}))},t.prototype.read=function(){return n(this,void 0,void 0,(function(){var t,e,n=this;return r(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(t,e){n.device.read((function(n,r){if(n)return e(new Error(n));t(r)}))}))];case 1:return t=r.sent(),e=new Uint8Array(t).buffer,[2,new DataView(e)]}}))}))},t.prototype.write=function(t){return n(this,void 0,void 0,(function(){var e,n;return r(this,(function(r){for(e=function(t){return void 0!==t.buffer}(t)?t.buffer:t,n=Array.prototype.slice.call(new Uint8Array(e));n.length<this.packetSize;)n.push(0);if("win32"===this.os&&n.unshift(0),this.device.write(n)!==n.length)throw new Error("Incorrect bytecount written");return[2]}))}))},t}(),E=function(){function t(t,e,n,r){void 0===e&&(e=255),void 0===n&&(n=1),void 0===r&&(r=!1),this.device=t,this.interfaceClass=e,this.configuration=n,this.alwaysControlTransfer=r,this.packetSize=64}return t.prototype.bufferToDataView=function(t){var e=new Uint8Array(t).buffer;return new DataView(e)},t.prototype.isView=function(t){return void 0!==t.buffer},t.prototype.bufferSourceToBuffer=function(t){var e=this.isView(t)?t.buffer:t;return Buffer.from(e)},t.prototype.extendBuffer=function(t,e){var n=this.isView(t)?t.buffer:t,r=Math.min(n.byteLength,e),i=new Uint8Array(r);return i.set(new Uint8Array(n)),i},t.prototype.open=function(){return n(this,void 0,void 0,(function(){var t,e,n,i,s,o,c,u=this;return r(this,(function(r){switch(r.label){case 0:return this.device.open(),[4,new Promise((function(t,e){u.device.setConfiguration(u.configuration,(function(n){n?e(new Error(n.message)):t()}))}))];case 1:if(r.sent(),!(null==(t=null===(c=this.device.interfaces)||void 0===c?void 0:c.filter((function(t){return t.descriptor.bInterfaceClass===u.interfaceClass})))?void 0:t.length))throw new Error("No valid interfaces found.");if((e=t.find((function(t){return t.endpoints.length>0})))||(e=t[0]),this.interfaceNumber=e.interfaceNumber,!this.alwaysControlTransfer){for(n=e.endpoints,this.endpointIn=void 0,this.endpointOut=void 0,i=0,s=n;i<s.length;i++)"in"!==(o=s[i]).direction||this.endpointIn?"out"!==o.direction||this.endpointOut||(this.endpointOut=o):this.endpointIn=o;if(this.endpointIn||this.endpointOut)try{e.claim()}catch(t){this.endpointIn=void 0,this.endpointOut=void 0}}return[2]}}))}))},t.prototype.close=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return this.device.close(),[2]}))}))},t.prototype.read=function(){return n(this,void 0,void 0,(function(){var t,e=this;return r(this,(function(n){switch(n.label){case 0:if(void 0===this.interfaceNumber)throw new Error("No device opened");return[4,new Promise((function(t,n){e.endpointIn?e.endpointIn.transfer(e.packetSize,(function(e,r){e?n(e):t(void 0!==r?r:new Buffer(0))})):e.device.controlTransfer(161,1,256,e.interfaceNumber,e.packetSize,(function(e,r){e?n(e):r?t(r):n(new Error("No buffer read"))}))}))];case 1:return t=n.sent(),[2,this.bufferToDataView(t)]}}))}))},t.prototype.write=function(t){return n(this,void 0,void 0,(function(){var e,n,i=this;return r(this,(function(r){switch(r.label){case 0:if(void 0===this.interfaceNumber)throw new Error("No device opened");return e=this.extendBuffer(t,this.packetSize),n=this.bufferSourceToBuffer(e),[4,new Promise((function(t,e){i.endpointOut?i.endpointOut.transfer(n,(function(n){if(n)return e(n);t()})):i.device.controlTransfer(33,9,512,i.interfaceNumber,n,(function(n){if(n)return e(n);t()}))}))];case 1:return r.sent(),[2]}}))}))},t}(),M=function(){function t(t,e,n,r){void 0===e&&(e=255),void 0===n&&(n=1),void 0===r&&(r=!1),this.device=t,this.interfaceClass=e,this.configuration=n,this.alwaysControlTransfer=r,this.packetSize=64}return t.prototype.extendBuffer=function(t,e){var n=void 0!==t.buffer?t.buffer:t,r=Math.min(n.byteLength,e),i=new Uint8Array(r);return i.set(new Uint8Array(n)),i},t.prototype.open=function(){return n(this,void 0,void 0,(function(){var t,e,n,i,s,o,c=this;return r(this,(function(r){switch(r.label){case 0:return[4,this.device.open()];case 1:return r.sent(),[4,this.device.selectConfiguration(this.configuration)];case 2:if(r.sent(),!(t=this.device.configuration.interfaces.filter((function(t){return t.alternates[0].interfaceClass===c.interfaceClass}))).length)throw new Error("No valid interfaces found.");if((e=t.find((function(t){return t.alternates[0].endpoints.length>0})))||(e=t[0]),this.interfaceNumber=e.interfaceNumber,!this.alwaysControlTransfer)for(n=e.alternates[0].endpoints,this.endpointIn=void 0,this.endpointOut=void 0,i=0,s=n;i<s.length;i++)"in"!==(o=s[i]).direction||this.endpointIn?"out"!==o.direction||this.endpointOut||(this.endpointOut=o):this.endpointIn=o;return[2,this.device.claimInterface(this.interfaceNumber)]}}))}))},t.prototype.close=function(){return this.device.close()},t.prototype.read=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(e){switch(e.label){case 0:if(void 0===this.interfaceNumber)throw new Error("No device opened");return this.endpointIn?[4,this.device.transferIn(this.endpointIn.endpointNumber,this.packetSize)]:[3,2];case 1:return t=e.sent(),[3,4];case 2:return[4,this.device.controlTransferIn({requestType:"class",recipient:"interface",request:1,value:256,index:this.interfaceNumber},this.packetSize)];case 3:t=e.sent(),e.label=4;case 4:return[2,t.data]}}))}))},t.prototype.write=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:if(void 0===this.interfaceNumber)throw new Error("No device opened");return e=this.extendBuffer(t,this.packetSize),this.endpointOut?[4,this.device.transferOut(this.endpointOut.endpointNumber,e)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,this.device.controlTransferOut({requestType:"class",recipient:"interface",request:9,value:512,index:this.interfaceNumber},e)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t}(),P=function(){function t(t){this.device=t,this.packetSize=64}return t.prototype.open=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.device.open()];case 1:return t.sent(),[2]}}))}))},t.prototype.close=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.device.close()];case 1:return t.sent(),[2]}}))}))},t.prototype.read=function(){return n(this,void 0,void 0,(function(){var t=this;return r(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){t.device.oninputreport=function(t){e(t.data)}}))];case 1:return[2,e.sent()]}}))}))},t.prototype.write=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return e=new Uint8Array(t),[4,this.device.sendReport(144,e)];case 1:return n.sent(),[2]}}))}))},t}();export{A as ADI,p as CmsisDAP,C as CortexM,b as DAPLink,l as DEFAULT_CLOCK_FREQUENCY,f as FPBCtrlMask,U as HID,E as USB,P as WebHID,M as WebUSB};
//# sourceMappingURL=dap.esm.js.map
